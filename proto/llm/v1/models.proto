syntax = "proto3";
package llm.v1;

import "buf/validate/validate.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";

message Provider {
  string id = 1;
  string title = 2;
  string name = 3;
  string description = 4;
  google.protobuf.Struct config = 5;
}

message Model {
  string name = 1;
  string value = 2;
}

message ProviderModels {
  string name = 1;
  repeated Model models = 2;
}

enum FinishReason {
  FINISH_REASON_UNSPECIFIED = 0;
  FINISH_REASON_LENGTH = 1;
  FINISH_REASON_STOP = 2;
  FINISH_REASON_ERROR = 3;
}

message Usage {
  // number of tokens in the prompt.
  optional int32 prompt_tokens = 1;

  // number of tokens in the generated completion.
  optional int32 completion_tokens = 2;

  // total number of tokens used in the request (prompt + completion).
  optional int32 total_tokens = 3;
}

message Function {
  string name = 1;
  string arguments = 2;
}

message ToolCallMessage {
  string id = 1;
  string type = 2;
  Function function = 3;
}

message ChatCompletionMessage {
  // role of the message author. One of "system", "user", "assistant".
  string role = 1 [(buf.validate.field).required = true];
  // content of the message
  string content = 2 [(buf.validate.field).required = true];
  google.protobuf.Struct logprobs = 3;
  repeated ToolCallMessage tool_calls = 4;
}

message CompletionChoice {
  // index of the choice in the list of choices.
  uint32 index = 1;
  // message generated by the model.
  ChatCompletionMessage message = 2;
  google.protobuf.Struct logprobs = 3;
  string finish_reason = 4;
}

message Role {
  oneof role {
    string system = 1;
    string user = 2;
    string assistant = 3;
  }
}

message ResponseFormat {
  string type = 1;
}

message APIKey {
  string id = 1;
  string name = 2;
  string value = 3;
  string masked_value = 4;
  google.protobuf.Timestamp created_at = 5;
  google.protobuf.Timestamp last_used_at = 6;
}
